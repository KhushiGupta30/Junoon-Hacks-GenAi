const partnerRateCards = {
  "A F Xpress": {
    baseRate: 150,
    perKmRate: 2.0,
    perKgRate: 45,
    type: "standard",
    mode: "air",
  },

  "Esquire Express India P Ltd": {
    baseRate: 100,
    perKmRate: 1.5,
    perKgRate: 40,
    type: "standard",
    mode: "mixed",
  },

  "Esquire Express India P Ltd_Express": {
    baseRate: 200,
    perKmRate: 2.5,
    perKgRate: 80,
    type: "premium",
    mode: "air",
  },

  "AARGUS Global Logistics Pvt Ltd": {
    baseRate: 120,
    perKmRate: 1.8,
    perKgRate: 50,
    type: "standard",
    mode: "mixed",
  },

  "Address India": {
    baseRate: 60,
    perKmRate: 1.0,
    perKgRate: 35,
    type: "budget",
    mode: "land",
  },

  "Ahura Express": {
    baseRate: 70,
    perKmRate: 1.2,
    perKgRate: 38,
    type: "budget",
    mode: "land",
  },

  "Airlogix Solutions": {
    baseRate: 150,
    perKmRate: 2.2,
    perKgRate: 55,
    type: "premium",
    mode: "air",
  },

  "Airwin Cargo Service": {
    baseRate: 80,
    perKmRate: 1.3,
    perKgRate: 40,
    type: "standard",
    mode: "mixed",
  },

  "Airwin Cargo Service_Express": {
    baseRate: 150,
    perKmRate: 2.0,
    perKgRate: 70,
    type: "premium",
    mode: "air",
  },

  "AJW Express Service Pvt Ltd": {
    baseRate: 90,
    perKmRate: 1.4,
    perKgRate: 42,
    type: "standard",
    mode: "mixed",
  },

  "AJW Express Service Pvt Ltd_Economy": {
    baseRate: 50,
    perKmRate: 0.8,
    perKgRate: 28,
    type: "budget",
    mode: "land",
  },

  "Amigo Logistics": {
    baseRate: 130,
    perKmRate: 1.9,
    perKgRate: 52,
    type: "standard",
    mode: "air",
  },

  "Apex International": {
    baseRate: 120,
    perKmRate: 1.5,
    perKgRate: 60,
    type: "standard",
    mode: "mixed",
  },

  "Apex International_Domestic": {
    baseRate: 60,
    perKmRate: 1.0,
    perKgRate: 35,
    type: "budget",
    mode: "land",
  },

  "Aramex India Pvt": {
    baseRate: 200,
    perKmRate: 2.5,
    perKgRate: 75,
    type: "premium",
    mode: "air",
  },

  "Aramex India Pvt_Economy": {
    baseRate: 120,
    perKmRate: 1.5,
    perKgRate: 50,
    type: "standard",
    mode: "mixed",
  },

  "Best Overall Air Cargo": {
    baseRate: 140,
    perKmRate: 2.0,
    perKgRate: 58,
    type: "standard",
    mode: "air",
  },

  "Bombino Express Pvt": {
    baseRate: 50,
    perKmRate: 1.0,
    perKgRate: 31,
    type: "budget",
    mode: "land",
  },

  "Bombino Express Pvt_International": {
    baseRate: 150,
    perKmRate: 3.0,
    perKgRate: 220,
    type: "premium",
    mode: "air",
  },

  "Budget Couriers Private Limited": {
    baseRate: 45,
    perKmRate: 0.8,
    perKgRate: 30,
    type: "budget",
    mode: "land",
  },

  "Chain Express Courier": {
    baseRate: 65,
    perKmRate: 1.1,
    perKgRate: 36,
    type: "budget",
    mode: "land",
  },

  "CNT Courier & Cargo": {
    baseRate: 70,
    perKmRate: 1.2,
    perKgRate: 38,
    type: "standard",
    mode: "mixed",
  },

  "Dart Air Services": {
    baseRate: 110,
    perKmRate: 1.6,
    perKgRate: 48,
    type: "standard",
    mode: "air",
  },

  "DHL Express India Private Limited": {
    baseRate: 220,
    perKmRate: 3.0,
    perKgRate: 100,
    type: "premium",
    mode: "air",
  },

  "DHL Express India Private Limited_Standard": {
    baseRate: 150,
    perKmRate: 2.0,
    perKgRate: 75,
    type: "standard",
    mode: "air",
  },

  "Digital Courier and Cargo": {
    baseRate: 55,
    perKmRate: 0.9,
    perKgRate: 32,
    type: "budget",
    mode: "land",
  },

  "DTDC Courier Cargo": {
    baseRate: 60,
    perKmRate: 1.0,
    perKgRate: 40,
    type: "budget",
    mode: "land",
  },

  "DTDC Courier Cargo_Express": {
    baseRate: 100,
    perKmRate: 1.5,
    perKgRate: 70,
    type: "standard",
    mode: "mixed",
  },

  "DTDC Courier Cargo_Prime": {
    baseRate: 150,
    perKmRate: 2.0,
    perKgRate: 100,
    type: "premium",
    mode: "air",
  },

  "Envee International": {
    baseRate: 90,
    perKmRate: 1.4,
    perKgRate: 45,
    type: "standard",
    mode: "mixed",
  },

  "EOL Express": {
    baseRate: 75,
    perKmRate: 1.2,
    perKgRate: 40,
    type: "standard",
    mode: "mixed",
  },

  "Everest International": {
    baseRate: 95,
    perKmRate: 1.5,
    perKgRate: 46,
    type: "standard",
    mode: "mixed",
  },

  "Express Parcel Service": {
    baseRate: 70,
    perKmRate: 1.1,
    perKgRate: 38,
    type: "standard",
    mode: "land",
  },

  "Fardar Express India": {
    baseRate: 85,
    perKmRate: 1.3,
    perKgRate: 42,
    type: "standard",
    mode: "mixed",
  },

  "Fast Forward Express": {
    baseRate: 80,
    perKmRate: 1.3,
    perKgRate: 40,
    type: "standard",
    mode: "land",
  },

  "Fast Track Express LLP": {
    baseRate: 90,
    perKmRate: 1.4,
    perKgRate: 44,
    type: "standard",
    mode: "mixed",
  },

  FedEx: {
    baseRate: 200,
    perKmRate: 2.8,
    perKgRate: 90,
    type: "premium",
    mode: "air",
  },

  FedEx_Standard: {
    baseRate: 150,
    perKmRate: 2.0,
    perKgRate: 75,
    type: "standard",
    mode: "air",
  },

  FedEx_Ground: {
    baseRate: 100,
    perKmRate: 1.5,
    perKgRate: 50,
    type: "standard",
    mode: "land",
  },

  "Fflybird Shipping So": {
    baseRate: 75,
    perKmRate: 1.2,
    perKgRate: 40,
    type: "standard",
    mode: "mixed",
  },

  "FPS Logistics": {
    baseRate: 80,
    perKmRate: 1.3,
    perKgRate: 42,
    type: "standard",
    mode: "mixed",
  },

  "Freight Net Pvt Ltd": {
    baseRate: 110,
    perKmRate: 1.6,
    perKgRate: 50,
    type: "standard",
    mode: "mixed",
  },

  "Gati Limited": {
    baseRate: 85,
    perKmRate: 1.4,
    perKgRate: 45,
    type: "standard",
    mode: "land",
  },

  "Gati Limited_Express": {
    baseRate: 130,
    perKmRate: 2.0,
    perKgRate: 65,
    type: "premium",
    mode: "air",
  },

  "Gauri Exporters": {
    baseRate: 95,
    perKmRate: 1.5,
    perKgRate: 48,
    type: "standard",
    mode: "mixed",
  },

  "Grand Slam Express": {
    baseRate: 75,
    perKmRate: 1.2,
    perKgRate: 40,
    type: "standard",
    mode: "land",
  },

  "Green Dot Air Express": {
    baseRate: 120,
    perKmRate: 1.8,
    perKgRate: 55,
    type: "standard",
    mode: "air",
  },

  "ICR India": {
    baseRate: 70,
    perKmRate: 1.1,
    perKgRate: 38,
    type: "standard",
    mode: "mixed",
  },

  "Indian Courier Service": {
    baseRate: 65,
    perKmRate: 1.0,
    perKgRate: 36,
    type: "budget",
    mode: "land",
  },

  "International City": {
    baseRate: 100,
    perKmRate: 1.5,
    perKgRate: 50,
    type: "standard",
    mode: "mixed",
  },

  "Jaideep Enterprises": {
    baseRate: 75,
    perKmRate: 1.2,
    perKgRate: 40,
    type: "standard",
    mode: "land",
  },

  "KB Courier and Cargo": {
    baseRate: 70,
    perKmRate: 1.1,
    perKgRate: 38,
    type: "standard",
    mode: "land",
  },

  "Linehaul Express (I) Pvt. Ltd": {
    baseRate: 90,
    perKmRate: 1.4,
    perKgRate: 45,
    type: "standard",
    mode: "mixed",
  },

  "MCTRANS Global Logistics": {
    baseRate: 105,
    perKmRate: 1.6,
    perKgRate: 52,
    type: "standard",
    mode: "mixed",
  },

  "Natbro India Pvt Ltd": {
    baseRate: 80,
    perKmRate: 1.3,
    perKgRate: 42,
    type: "standard",
    mode: "mixed",
  },

  "NG Pillai": {
    baseRate: 75,
    perKmRate: 1.2,
    perKgRate: 40,
    type: "standard",
    mode: "land",
  },

  "On Time Courier": {
    baseRate: 70,
    perKmRate: 1.1,
    perKgRate: 38,
    type: "standard",
    mode: "land",
  },

  "Orbit Trans Express": {
    baseRate: 80,
    perKmRate: 1.3,
    perKgRate: 42,
    type: "standard",
    mode: "mixed",
  },

  "Overseas Courier Service": {
    baseRate: 110,
    perKmRate: 1.7,
    perKgRate: 55,
    type: "standard",
    mode: "air",
  },

  "Overseas Logistics": {
    baseRate: 95,
    perKmRate: 1.5,
    perKgRate: 48,
    type: "standard",
    mode: "mixed",
  },

  "Pace Projects Logistics": {
    baseRate: 100,
    perKmRate: 1.5,
    perKgRate: 50,
    type: "standard",
    mode: "mixed",
  },

  "Perfect Worldwide": {
    baseRate: 85,
    perKmRate: 1.4,
    perKgRate: 45,
    type: "standard",
    mode: "mixed",
  },

  "Power Line Air Express": {
    baseRate: 125,
    perKmRate: 1.8,
    perKgRate: 58,
    type: "standard",
    mode: "air",
  },

  "Prime Express Courier": {
    baseRate: 75,
    perKmRate: 1.2,
    perKgRate: 40,
    type: "standard",
    mode: "land",
  },

  "Professional Intl Courier": {
    baseRate: 140,
    perKmRate: 2.0,
    perKgRate: 65,
    type: "premium",
    mode: "air",
  },

  "PSH Air Private Ltd": {
    baseRate: 130,
    perKmRate: 1.9,
    perKgRate: 60,
    type: "standard",
    mode: "air",
  },

  "Rajab Logistics": {
    baseRate: 80,
    perKmRate: 1.3,
    perKgRate: 42,
    type: "standard",
    mode: "mixed",
  },

  "Rajdhani Air Express": {
    baseRate: 115,
    perKmRate: 1.7,
    perKgRate: 54,
    type: "standard",
    mode: "air",
  },

  "Relevant Couriers": {
    baseRate: 70,
    perKmRate: 1.1,
    perKgRate: 38,
    type: "standard",
    mode: "land",
  },

  "Reliable Logistics": {
    baseRate: 85,
    perKmRate: 1.4,
    perKgRate: 44,
    type: "standard",
    mode: "mixed",
  },

  "Royal India Courier": {
    baseRate: 75,
    perKmRate: 1.2,
    perKgRate: 40,
    type: "standard",
    mode: "land",
  },

  "Royale International": {
    baseRate: 110,
    perKmRate: 1.6,
    perKgRate: 52,
    type: "standard",
    mode: "mixed",
  },

  "S M Logistics": {
    baseRate: 75,
    perKmRate: 1.2,
    perKgRate: 40,
    type: "standard",
    mode: "land",
  },

  "Safeline Logistics": {
    baseRate: 80,
    perKmRate: 1.3,
    perKgRate: 42,
    type: "standard",
    mode: "mixed",
  },

  "SAR Worldwide": {
    baseRate: 95,
    perKmRate: 1.5,
    perKgRate: 48,
    type: "standard",
    mode: "mixed",
  },

  "SB Forwarders Logistics": {
    baseRate: 90,
    perKmRate: 1.4,
    perKgRate: 46,
    type: "standard",
    mode: "mixed",
  },

  "SCA Cargo System": {
    baseRate: 100,
    perKmRate: 1.5,
    perKgRate: 50,
    type: "standard",
    mode: "mixed",
  },

  "Sea Breeze Couriers": {
    baseRate: 70,
    perKmRate: 1.1,
    perKgRate: 38,
    type: "standard",
    mode: "land",
  },

  "SGK Express": {
    baseRate: 75,
    perKmRate: 1.2,
    perKgRate: 40,
    type: "standard",
    mode: "land",
  },

  "Signature Logistics": {
    baseRate: 85,
    perKmRate: 1.4,
    perKgRate: 44,
    type: "standard",
    mode: "mixed",
  },

  "Skynet Logistics": {
    baseRate: 95,
    perKmRate: 1.5,
    perKgRate: 48,
    type: "standard",
    mode: "mixed",
  },

  "Speedway Cargo": {
    baseRate: 80,
    perKmRate: 1.3,
    perKgRate: 42,
    type: "standard",
    mode: "land",
  },

  "ST Cargo": {
    baseRate: 70,
    perKmRate: 1.1,
    perKgRate: 38,
    type: "standard",
    mode: "land",
  },

  "Suntika Courier": {
    baseRate: 65,
    perKmRate: 1.0,
    perKgRate: 36,
    type: "budget",
    mode: "land",
  },

  "TB Xpress Services": {
    baseRate: 75,
    perKmRate: 1.2,
    perKgRate: 40,
    type: "standard",
    mode: "land",
  },

  "Time Express Logistics": {
    baseRate: 80,
    perKmRate: 1.3,
    perKgRate: 42,
    type: "standard",
    mode: "mixed",
  },

  "TNT India Private Ltd": {
    baseRate: 180,
    perKmRate: 2.5,
    perKgRate: 85,
    type: "premium",
    mode: "air",
  },

  "Transpeak Couriers": {
    baseRate: 85,
    perKmRate: 1.4,
    perKgRate: 44,
    type: "standard",
    mode: "mixed",
  },

  "Trident Express Cargo": {
    baseRate: 90,
    perKmRate: 1.4,
    perKgRate: 46,
    type: "standard",
    mode: "mixed",
  },

  "U B Xpress West": {
    baseRate: 75,
    perKmRate: 1.2,
    perKgRate: 40,
    type: "standard",
    mode: "land",
  },

  UBXPRESS: {
    baseRate: 75,
    perKmRate: 1.2,
    perKgRate: 40,
    type: "standard",
    mode: "land",
  },

  "UDX Worldwide": {
    baseRate: 100,
    perKmRate: 1.5,
    perKgRate: 50,
    type: "standard",
    mode: "mixed",
  },

  "Unique Air Express": {
    baseRate: 120,
    perKmRate: 1.8,
    perKgRate: 56,
    type: "standard",
    mode: "air",
  },

  "Unique Express": {
    baseRate: 75,
    perKmRate: 1.2,
    perKgRate: 40,
    type: "standard",
    mode: "land",
  },

  "United Business Xpress": {
    baseRate: 80,
    perKmRate: 1.3,
    perKgRate: 42,
    type: "standard",
    mode: "mixed",
  },

  "United Freight Service": {
    baseRate: 105,
    perKmRate: 1.6,
    perKgRate: 52,
    type: "standard",
    mode: "mixed",
  },

  UPS: {
    baseRate: 190,
    perKmRate: 2.6,
    perKgRate: 88,
    type: "premium",
    mode: "air",
  },

  UPS_Ground: {
    baseRate: 110,
    perKmRate: 1.6,
    perKgRate: 55,
    type: "standard",
    mode: "land",
  },

  "Urgent Air Courier": {
    baseRate: 130,
    perKmRate: 1.9,
    perKgRate: 60,
    type: "premium",
    mode: "air",
  },

  "VS Express LLP": {
    baseRate: 75,
    perKmRate: 1.2,
    perKgRate: 40,
    type: "standard",
    mode: "land",
  },

  "World Parcel Xpress": {
    baseRate: 95,
    perKmRate: 1.5,
    perKgRate: 48,
    type: "standard",
    mode: "mixed",
  },

  "Worldwide Express Couriers": {
    baseRate: 100,
    perKmRate: 1.5,
    perKgRate: 50,
    type: "standard",
    mode: "mixed",
  },

  "Yashika Logistics In": {
    baseRate: 80,
    perKmRate: 1.3,
    perKgRate: 42,
    type: "standard",
    mode: "mixed",
  },

  "Blue Dart_Domestic Priority": {
    baseRate: 150,
    perKmRate: 2.5,
    perKgRate: 65,
    type: "premium",
    mode: "air",
  },

  "Blue Dart_Apex": {
    baseRate: 200,
    perKmRate: 3.0,
    perKgRate: 80,
    type: "premium",
    mode: "air",
  },

  "Blue Dart_Surfaceline": {
    baseRate: 80,
    perKmRate: 1.3,
    perKgRate: 45,
    type: "standard",
    mode: "land",
  },

  Delhivery_Express: {
    baseRate: 80,
    perKmRate: 1.5,
    perKgRate: 40,
    type: "standard",
    mode: "mixed",
  },

  Delhivery_Surface: {
    baseRate: 50,
    perKmRate: 0.9,
    perKgRate: 30,
    type: "budget",
    mode: "land",
  },

  "India Post_Speed Post": {
    baseRate: 35,
    perKmRate: 0.6,
    perKgRate: 25,
    type: "budget",
    mode: "land",
  },

  "India Post_Regular": {
    baseRate: 25,
    perKmRate: 0.4,
    perKgRate: 20,
    type: "budget",
    mode: "land",
  },
};

const remoteLocations = ["Port Blair", "Leh", "Aizawl", "Itanagar", "Agartala"];

class LogisticsAdvisorService {
  /**
   * Generates logistics recommendations for a given order.
   * @param {object} order - The order document from Firestore.
   * @returns {Array<object>} A list of recommended partners with estimated costs.
   */
  static getRecommendations(order) {
    const { distanceKm, packageWeightKg, destinationCity } = order.logistics;
    const recommendations = [];

    const isRemote = remoteLocations.includes(destinationCity);
    const isLongDistance = distanceKm > 1000;

    for (const partnerName in partnerRateCards) {
      const partner = partnerRateCards[partnerName];

      if (isRemote && partner.mode !== "air") {
        continue;
      }

      const distanceCost = partner.perKmRate * distanceKm;
      const weightCost = partner.perKgRate * packageWeightKg;
      const estimatedPrice = partner.baseRate + distanceCost + weightCost;

      recommendations.push({
        partnerName,
        logoUrl: `/${partnerName.toLowerCase().replace(" ", "")}.png`,
        estimatedPrice: Math.ceil(estimatedPrice),
        reason: this.getReason(partner, isRemote, isLongDistance),
      });
    }

    return recommendations
      .sort((a, b) => a.estimatedPrice - b.estimatedPrice)
      .slice(0, 3);
  }

  static getReason(partner, isRemote) {
    if (isRemote && partner.mode === "air") {
      return "Recommended for remote delivery (Air Cargo).";
    }
    if (partner.type === "premium") {
      return "Fastest premium delivery via Air.";
    }
    if (partner.type === "budget" && partner.mode === "land") {
      return "Most budget-friendly option via Ground.";
    }
    if (partner.mode === "air") {
      return "Reliable standard delivery via Air.";
    }
    return "Reliable standard ground delivery.";
  }
}

module.exports = LogisticsAdvisorService;
